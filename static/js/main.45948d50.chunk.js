(this["webpackJsonpreact-api-request"]=this["webpackJsonpreact-api-request"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(8),s=n.n(o),l=(n(14),n(2)),c=n(3),r=n(5),d=n(4),u=n(1),h=n(6),f=(n(15),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(r.a)(this,Object(d.a)(t).call(this,e))).state={listVisible:!1},n.showDropdownMenu=n.showDropdownMenu.bind(Object(u.a)(n)),n.hideDropdownMenu=n.hideDropdownMenu.bind(Object(u.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"select",value:function(e){this.props.handleChange(e)}},{key:"showDropdownMenu",value:function(e){var t=this;e.preventDefault(),this.setState({listVisible:!0},(function(){document.addEventListener("click",t.hideDropdownMenu)}))}},{key:"hideDropdownMenu",value:function(){var e=this;this.setState({listVisible:!1},(function(){document.removeEventListener("click",e.hideDropdownMenu)}))}},{key:"render",value:function(){var e=this,t=this.props.selected.length>0?this.props.selected:this.props.defaultValue;return i.a.createElement("div",{className:"dropdown-container ".concat(this.state.listVisible?"show":"")},i.a.createElement("div",{className:"dropdown-display ".concat(this.state.listVisible?"clicked":""),onClick:this.showDropdownMenu},i.a.createElement("span",null,t),i.a.createElement("i",{className:"angle-down"})),i.a.createElement("div",{className:"dropdown-list",style:{display:"".concat(this.state.listVisible?"block":"none")}},i.a.createElement("ul",null,i.a.createElement("li",{onClick:this.select.bind(this,null)},i.a.createElement("a",null,i.a.createElement("span",null,this.props.defaultValue))),this.props.list.map((function(t,n){var a=0===e.props.flag?t.City:t.Town;return i.a.createElement("li",{key:n,onClick:e.select.bind(e,t)},i.a.createElement("a",null,i.a.createElement("span",null,a)))})))))}}]),t}(i.a.Component)),m=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(r.a)(this,Object(d.a)(t).call(this,e))).state={data:[],citySelected:"",town:[],townSeleted:"",foodData:[],isLoading:!0},n.handleCityChange=n.handleCityChange.bind(Object(u.a)(n)),n.handleTownChange=n.handleTownChange.bind(Object(u.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"handleCityChange",value:function(e){var t=e?e.City:"";this.setState({citySelected:t,townSeleted:""}),this.updateTown(t)}},{key:"updateTown",value:function(e){var t=this.state.data,n=Object.keys(t).reduce((function(n,a){return e.includes(t[a].City)&&(n[a]=t[a]),n}),{}),a=Object.values(n),i=0===a.length?t:a;this.setState({town:a,foodData:i})}},{key:"handleTownChange",value:function(e){var t=e?e.Town:"",n=0===t.length?0===this.state.citySelected.length?this.state.data:this.state.town:this.state.town.filter((function(e){return e.Town===t}));this.setState({townSeleted:t,foodData:n})}},{key:"componentDidMount",value:function(){var e=this;if(null===localStorage.getItem("travelFoodList")){fetch("".concat("https://cors-anywhere.herokuapp.com/").concat("https://data.coa.gov.tw/Service/OpenData/ODwsv/ODwsvTravelFood.aspx")).then((function(e){return e.json()})).then((function(t){e.setState({data:t,foodData:t,isLoading:!1}),localStorage.setItem("travelFoodList",JSON.stringify(t))}))}else{var t=localStorage.getItem("travelFoodList");e.setState({data:JSON.parse(t),foodData:JSON.parse(t),isLoading:!1})}}},{key:"render",value:function(){var e=this.state,t=e.data,n=e.town,a=e.foodData,o=e.citySelected,s=e.townSeleted,l=e.isLoading,c=t.filter((function(e,t,n){return n.findIndex((function(t){return t.City===e.City}))===t})),r=n.filter((function(e,t,n){return n.findIndex((function(t){return t.Town===e.Town}))===t})),d=l?i.a.createElement("div",{className:"loader-wrap"},i.a.createElement("div",{className:"loader"})):i.a.createElement("div",{className:"items-wrapper"},a.map((function(e,t){return i.a.createElement("div",{key:t,className:"item"},i.a.createElement("div",{className:"items-mask"}),i.a.createElement("img",{src:"".concat(e.PicURL),alt:"".concat(e.Name)}),i.a.createElement("div",{className:"city"},e.City),i.a.createElement("div",{className:"food-info"},i.a.createElement("div",{className:"town"},e.Town),i.a.createElement("div",{className:"name"},e.Name),i.a.createElement("div",{className:"hostWords"},i.a.createElement("hr",null),e.HostWords)))})));return i.a.createElement("div",{id:"wrapper"},i.a.createElement("h1",{id:"title"},"\u8fb2\u6751\u5730\u65b9\u7f8e\u98df\u5c0f\u5403\u7279\u8272\u6599\u7406"),i.a.createElement("div",{className:"select-fields"},i.a.createElement("fieldset",{className:"fields"},i.a.createElement(f,{list:c,handleChange:this.handleCityChange,defaultValue:"\u8acb\u9078\u64c7\u884c\u653f\u5340\u57df...",flag:0,selected:o}),i.a.createElement(f,{list:r,handleChange:this.handleTownChange,defaultValue:"\u8acb\u9078\u64c7\u9109\u93ae\u5340...",flag:1,selected:s}))),i.a.createElement("div",{id:"Container"},i.a.createElement("div",{className:"items-container"},d)),i.a.createElement("footer",null,"\u653f\u5e9c\u8cc7\u6599\u958b\u653e\u5e73\u53f0",i.a.createElement("br",null),"https://data.gov.tw/dataset/6037"))}}]),t}(i.a.Component),p=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function v(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(i.a.createElement(m,null),document.getElementById("app")),function(e){if("serviceWorker"in navigator){if(new URL("/react-api-request",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/react-api-request","/service-worker.js");p?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):v(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):v(t,e)}))}}()},9:function(e,t,n){e.exports=n(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.45948d50.chunk.js.map
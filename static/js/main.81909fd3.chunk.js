(this["webpackJsonpreact-api-request"]=this["webpackJsonpreact-api-request"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(8),s=n.n(i),c=(n(14),n(2)),l=n(3),r=n(5),d=n(4),u=n(1),h=n(6),f=(n(15),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(r.a)(this,Object(d.a)(t).call(this,e))).state={listVisible:!1},n.showDropdownMenu=n.showDropdownMenu.bind(Object(u.a)(n)),n.hideDropdownMenu=n.hideDropdownMenu.bind(Object(u.a)(n)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"select",value:function(e){this.props.handleChange(e)}},{key:"showDropdownMenu",value:function(e){var t=this;e.preventDefault(),this.setState({listVisible:!0},(function(){document.addEventListener("click",t.hideDropdownMenu)}))}},{key:"hideDropdownMenu",value:function(){var e=this;this.setState({listVisible:!1},(function(){document.removeEventListener("click",e.hideDropdownMenu)}))}},{key:"render",value:function(){var e=this,t=this.props.selected.length>0?this.props.selected:this.props.defaultValue;return o.a.createElement("div",{className:"dropdown-container ".concat(this.state.listVisible?"show":"")},o.a.createElement("div",{className:"dropdown-display ".concat(this.state.listVisible?"clicked":""),onClick:this.showDropdownMenu},o.a.createElement("span",null,t),o.a.createElement("i",{className:"angle-down"})),o.a.createElement("div",{className:"dropdown-list",style:{display:"".concat(this.state.listVisible?"block":"none")}},o.a.createElement("ul",null,o.a.createElement("li",{onClick:this.select.bind(this,null)},o.a.createElement("a",null,o.a.createElement("span",null,this.props.defaultValue))),this.props.list.map((function(t,n){var a=0===e.props.flag?t.City:t.Town;return o.a.createElement("li",{key:n,onClick:e.select.bind(e,t)},o.a.createElement("a",null,o.a.createElement("span",null,a)))})))))}}]),t}(o.a.Component)),p=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(r.a)(this,Object(d.a)(t).call(this,e))).state={data:[],citySelected:"",town:[],townSeleted:"",foodData:[]},n.handleCityChange=n.handleCityChange.bind(Object(u.a)(n)),n.handleTownChange=n.handleTownChange.bind(Object(u.a)(n)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleCityChange",value:function(e){var t=e?e.City:"";this.setState({citySelected:t,townSeleted:""}),this.updateTown(t)}},{key:"updateTown",value:function(e){var t=this.state.data,n=Object.keys(t).reduce((function(n,a){return e.includes(t[a].City)&&(n[a]=t[a]),n}),{}),a=Object.values(n),o=0===a.length?t:a;this.setState({town:a,foodData:o})}},{key:"handleTownChange",value:function(e){var t=e?e.Town:"",n=0===t.length?this.state.town:this.state.town.filter((function(e){return e.Town===t}));this.setState({townSeleted:t,foodData:n})}},{key:"componentDidMount",value:function(){var e=this;if(null===localStorage.getItem("travelFoodList")){fetch("".concat("https://cors-anywhere.herokuapp.com/").concat("https://data.coa.gov.tw/Service/OpenData/ODwsv/ODwsvTravelFood.aspx")).then((function(e){return e.json()})).then((function(t){e.setState({data:t,foodData:t}),localStorage.setItem("travelFoodList",JSON.stringify(t))}))}else{var t=localStorage.getItem("travelFoodList");e.setState({data:JSON.parse(t),foodData:JSON.parse(t)})}}},{key:"render",value:function(){var e=this.state,t=e.data,n=e.town,a=e.foodData,i=e.citySelected,s=e.townSeleted,c=t.filter((function(e,t,n){return n.findIndex((function(t){return t.City===e.City}))===t})),l=n.filter((function(e,t,n){return n.findIndex((function(t){return t.Town===e.Town}))===t}));return o.a.createElement("div",{id:"wrapper"},o.a.createElement("h1",{id:"title"},"\u8fb2\u6751\u5730\u65b9\u7f8e\u98df\u5c0f\u5403\u7279\u8272\u6599\u7406 ","(".concat(this.state.foodData.length,")")),o.a.createElement("div",{className:"select-fields"},o.a.createElement("fieldset",{className:"fields"},o.a.createElement(f,{list:c,handleChange:this.handleCityChange,defaultValue:"\u8acb\u9078\u64c7\u884c\u653f\u5340\u57df...",flag:0,selected:i}),o.a.createElement(f,{list:l,handleChange:this.handleTownChange,defaultValue:"\u8acb\u9078\u64c7\u9109\u93ae\u5340...",flag:1,selected:s}))),o.a.createElement("div",{id:"Container"},o.a.createElement("div",{className:"items-container"},o.a.createElement("div",{className:"items-wrapper"},a.map((function(e,t){return o.a.createElement("div",{key:t,className:"item"},o.a.createElement("div",{className:"items-mask"}),o.a.createElement("img",{src:"".concat(e.PicURL),alt:"".concat(e.Name)}),o.a.createElement("div",{className:"city"},e.City),o.a.createElement("div",{className:"food-info"},o.a.createElement("div",{className:"town"},e.Town),o.a.createElement("div",{className:"name"},e.Name),o.a.createElement("div",{className:"hostWords"},o.a.createElement("hr",null),e.HostWords)))}))))))}}]),t}(o.a.Component),m=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function v(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(o.a.createElement(p,null),document.getElementById("app")),function(e){if("serviceWorker"in navigator){if(new URL("/react-api-request",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/react-api-request","/service-worker.js");m?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):v(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):v(t,e)}))}}()},9:function(e,t,n){e.exports=n(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.81909fd3.chunk.js.map